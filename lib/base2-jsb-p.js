new function(_){var JSB=new base2.Namespace(this,{name:"JSB",version:"0.7",imports:"DOM",exports:"Binding, Rule, RuleList"});eval(this.imports);var Binding=Abstract.extend();var Call=Base.extend({constructor:function(a,b,c,d){this.release=function(){b.apply(a,c)};this.rank=d||(100+Call.list.length)}},{list:[],defer:function(a,b){return function(){if(Call.list){Call.list.push(new Call(this,a,arguments,b))}else{a.apply(this,arguments)}}},init:function(){EventTarget.addEventListener(document,"DOMContentLoaded",function(){if(Call.list){DOM.bind(document);Call.list.sort(function(a,b){return a.rank-b.rank});invoke(Call.list,"release");delete Call.list;setTimeout(function(){EventTarget.dispatchEvent(document,'ready')},0)}},false)}});var Rule=Base.extend({constructor:function(c,d){c=new Selector(c);if(typeof d!="function"){d=Binding.extend(d)}var e={};function bind(a){var b=assignID(a);if(!e[b]){e[b]=true;d(DOM.bind(a))}};this.apply=Call.defer(function(){try{var a=c.exec(document)}catch(error){if(!instanceOf(error,SyntaxError))throw error;throw new SyntaxError(format("Selector '%1' is not supported by JSB",c));}forEach(a,bind)});this.toString=returns(String(c));this.apply()},apply:Undefined,refresh:function(){this.apply()}});var RuleList=Collection.extend({constructor:function(a){this.base(a);this.globalize()},globalize:Call.defer(function(){var e=/[^\s,]+/g;var f=/^#[\w-]+$/;forEach(this,function(c,d){forEach(match(d,e),function(a){if(f.test(a)){var b=ViewCSS.toCamelCase(a.slice(1));window[b]=Document.matchSingle(document,a)}})})},10),refresh:function(){this.invoke("refresh")}},{Item:Rule});extend(Event,{PATTERN:/^on(DOMContentLoaded|[a-z]+)$/,cancel:function(a){a.stopPropagation();a.preventDefault();return false}});extend(EventTarget,{addEventListener:function(a,b,c,d){if(b.indexOf("document")==0){b=b.slice(8);c=bind(c,a);a=Traversal.getDocument(a)}this.base(a,b,c,d)},removeEventListener:function(a,b,c,d){if(b.indexOf("document")==0){b=b.slice(8);a=Traversal.getDocument(a)}this.base(a,b,c,d)}});extend(HTMLElement.prototype,"extend",function(a,b){if(!base2.__prototyping&&arguments.length>=2){if(Event.PATTERN.test(a)&&typeof b=="function"){EventTarget.addEventListener(this,a.slice(2),b,false);return this}if(a=="style"){extend(this.style,b);return this}if(a=="extend")return this}return base(this,arguments)});eval(this.exports)};