new function(_){var JSB=new base2.Package(this,{name:"JSB",version:"0.8",imports:"DOM",exports:"Behavior,Rule,RuleList"});eval(this.imports);var _0;var Behavior=Abstract.extend();var Call=Base.extend({constructor:function(a,b,c,d){this.release=function(){b.apply(a,c)};this.rank=d||(100+Call.list.length)}},{list:[],defer:function(a,b){return function(){if(Call.list){Call.list.push(new Call(this,a,arguments,b))}else{a.apply(this,arguments)}}},init:function(){EventTarget.addEventListener(document,"DOMContentLoaded",function(){_0=DOM.bind[document.base2ID];if(Call.list){Call.list.sort(function(a,b){return a.rank-b.rank});invoke(Call.list,"release");delete Call.list;setTimeout(function(){var a=DocumentEvent.createEvent(document,"Events");Event.initEvent(a,"ready",false,false);EventTarget.dispatchEvent(document,a)},1)}},false)}});var Rule=Base.extend({constructor:function(e,f){e=new Selector(e);if(!Behavior.ancestorOf(f)){f=Behavior.extend(f)}var g,h={};var i={},j={};forEach(f.prototype,function(b,c){if(c.charAt(0)=="@"){if(detect(c.slice(1))){forEach(b,arguments.callee)}}else if(typeof b=="function"&&/^on[a-z]+$/.test(c)){if(c.indexOf("document")==2){EventTarget.addEventListener(document,c.slice(10),function(a){g.invoke(b,a)},false)}else{i[c.slice(2)]=b}}else{j[c]=b}});this.refresh=Call.defer(function(){g=e.exec();g.forEach(function(c){var d=assignID(c);if(!h[d]){h[d]=true;if(_0)DOM.bind(c);forEach(i,function(a,b){EventTarget.addEventListener(c,b,a,false)});extend(c,j)}})});this.toString=K(String(e));this.refresh()},refresh:Undefined});var RuleList=Collection.extend({constructor:function(a){this.base(a);this.globalize()},globalize:Call.defer(function(){var e=/[^\s,]+/g;var f=/^#[\w-]+$/;forEach(this,function(c,d){forEach(match(d,e),function(a){if(f.test(a)){var b=ViewCSS.toCamelCase(a.slice(1));window[b]=Document.querySelector(document,a)}})})},10),refresh:function(){this.invoke("refresh")}},{Item:Rule});eval(this.exports)};