<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<head>
<title>MiniWeb: /</title>
<script type="text/javascript" src="http://dean.edwards.test/base2/trunk/src/apps/MiniWeb/package.php?full"></script>
<script type="text/javascript">MiniWeb.data={"system":{"Administration":"<p>You are invited to customise MiniWeb:<\/p>\n<ul>\n <li>Test a <a href='#/dud'>dud<\/a> link<\/li>\n <li>Edit the default <a href='#/system/edit!/system/view'>view<\/a> (page structure)<\/li>\n <ul>\n  <li>Edit the <a href='#/system/edit!/system/header'>header<\/a> template<\/li>\n  <li>Edit the <a href='#/system/edit!/system/content'>content<\/a> template<\/li>\n  <li>Edit the <a href='#/system/edit!/system/footer'>footer<\/a> template<\/li>\n  <li>Edit the <a href='#/system/edit!/system/directory'>directory<\/a> template<\/li>\n  <li>Edit the <a href='#/system/view!/system/Error/'>error<\/a> page templates<\/li>\n  <li>Edit page <a href='#/system/edit!/system/view.css'>style<\/a><\/li>\n <\/ul><\/li>\n <li>Edit <a href='javascript:beginEdit()'>this<\/a> page<\/li>\n<\/ul>\n<p>Or have a look around:<\/p>\n<ul>\n <li>Go to the <a href='#/'>root<\/a> of the MiniWeb file system<\/li>\n <li>Go to the <a href='#/system'>system<\/a> directory<\/li>\n <li>Go to the <a href='#/examples/'>examples<\/a><\/li>\n<\/ul>\n<p>If you are feeling adventurous you can use the <a href='#/system/Terminal'>terminal<\/a> to modify the file system.<\/p>","Help":{"JST_Interpreter":"<p>The standard interpreter is based on <a href='http://erik.eae.net/'>Erik Arvidsson<\/a>&#8217;s <a href='http://erik.eae.net/archives/2005/05/27/01.03.26/'>ECMAScript Template Engine<\/a>. The <abbr title='JavaScript Templates'>JST<\/abbr> interpreter uses a command object to provide access to additional commands. The <abbr>JST<\/abbr> interpreter extends the <a href=\"#File_System\">FileSystem<\/a> object which provides methods for reading and writing files and directories.<\/p>\n<p>The extended MiniWeb command object supports the following properties and methods:<\/p>\n<h2>Properties<\/h2>\n<dl>\n<dt><code><small>string<\/small> parent<\/code><\/dt>\n<dd><p>The path of the parent template.<\/p><\/dd>\n<dt><code><small>object<\/small> request<\/code><\/dt>\n<dd><p>The current <a href='#Request'>Request<\/a> object (if there is one).<\/p><\/dd>\n<dt><code><small>string<\/small> self<\/code><\/dt>\n<dd><p>The path of the current template.<\/p><\/dd>\n<dt><code><small>string<\/small> target<\/code><\/dt>\n<dd><p>The current input buffer. Can be any kind of string data. Is quite often the path to another template.<\/p><\/dd>\n<dt><code><small>string<\/small> top<\/code><\/dt>\n<dd><p>The path of the top level template.<\/p><\/dd>\n<\/dl>\n<h2>Methods<\/h2>\n<dl>\n<dt><code><small>string<\/small> args(<i>names<\/i>)<\/code><\/dt>\n<dd><p>Treats the current target as if it were a space delimited list of arguments. <i>names<\/i> is a comma delimited list of names. This function defines variables in the current scope described by <i>names<\/i>. Returns the resulting argument list.<\/p>\n<p>For example:<\/p>\n<pre>\n&lt;%\n\nvar theArguments = args('name,value');\n\n// 'name' and 'value' are now defined in the current scope\necho(name + \":\" + value);\n\n// 'theArguments' is equivalent to JavaScript's arguments object\necho('Number of arguments is ' + theArguments.length);\n\n%&gt;<\/pre><\/dd>\n<dt><code><small>void<\/small> echo(<i>string<\/i>)<\/code><\/dt>\n<dd><p>Write <i>string<\/i> directly to the output buffer.<\/p><\/dd>\n<dt><code><small>string<\/small> escapeHTML(<i>string<\/i>)<\/code><\/dt>\n<dd><p>Replace certain characters (<code>\"&amp;'&lt;&gt;<\/code>) with the equivalent HTML entity.<\/p><\/dd>\n<dt><code><small>string<\/small> exec(<i>template<\/i> [, <i>target<\/i>])<\/code><\/dt>\n<dd><p>Evaluate the entry identified by <i>template<\/i> using <i>target<\/i> as the current target. Returns the resulting string.<\/p><\/dd>\n<dt><code><small>void<\/small> include(<i>path<\/i>)<\/code><\/dt>\n<dd><p>Evaluate the entry associated with <i>path<\/i> and write the results to the output buffer.<\/p><\/dd>\n<dt><code><small>void<\/small> include_once(<i>path<\/i>)<\/code><\/dt>\n<dd><p>As above but all further calls to <code>include_once<\/code> are ignored for the particular <i>path<\/i>.<\/p><\/dd>\n<dt><code><small>void<\/small> process(<i>template<\/i>, [<i>target<\/i> [, <i>...<\/i>]])<\/code><\/dt>\n<dd><p>Evaluate the entry associated with <i>template<\/i> using <i>target<\/i> as the current target. Do this for each entry associated with subsequent <i>target<\/i> arguments and <code>echo<\/code> the results.<\/p>\n<p>For example:<\/p>\n<pre>process(template, target1, target2);<\/pre>\n<p>is equivalent to:<\/p>\n<pre>echo(exec(template, target1);\necho(exec(template, target2);<\/pre><\/dd>\n<\/dl>\n<h2>Notes<\/h2>\n<p><em>There is no real distinction between a template and an entry.<\/em><\/p>\n","File_System":"<p>The file system object supports the following properties and methods:<\/p>\n<h2>Properties<\/h2>\n<dl>\n<dt><code><small>string<\/small> protocol<\/code><\/dt>\n<dd><p>The current protocol. Currently only <code>json:<\/code> is supoorted.<\/p><\/dd>\n<dt><code><small>string<\/small> path<\/code><\/dt>\n<dd><p>The current working directory.<\/p><\/dd>\n<\/dl>\n<h2>Methods<\/h2>\n<dl>\n<dt><code><small>string<\/small> chdir(<i>path<\/i>)<\/code><\/dt>\n<dd><p>Change the current working directory to <i>path<\/i>.<\/p><\/dd>\n<dt><code><small>string<\/small> copy(<i>path1<\/i>, <i>path2<\/i>)<\/code><\/dt>\n<dd><p>Copy the file found at <i>path1<\/i> to <i>path2<\/i>.<\/p><\/dd>\n<dt><code><small>boolean<\/small> exists(<i>path<\/i>)<\/code><\/dt>\n<dd><p>Verifies the existence of a file or directory.<\/p><\/dd>\n<dt><code><small>boolean<\/small> isDirectory(<i>path<\/i>)<\/code><\/dt>\n<dd><p>Verifies that the file found at <i>path<\/i> is a directory.<\/p><\/dd>\n<dt><code><small>boolean<\/small> isFile(<i>path<\/i>)<\/code><\/dt>\n<dd><p>Verifies that the file found at <i>path<\/i> is a file.<\/p><\/dd>\n<dt><code><small>boolean<\/small> mkdir(<i>path<\/i>)<\/code><\/dt>\n<dd><p>Create the directory described by <i>path<\/i>.<\/p><\/dd>\n<dt><code><small>void<\/small> move(<i>path1<\/i>, <i>path2<\/i>)<\/code><\/dt>\n<dd><p>Move the file found at <i>path1<\/i> to <i>path2<\/i>.<\/p><\/dd>\n<dt><code><small>varied<\/small> read(<i>path<\/i>)<\/code><\/dt>\n<dd><p>Read the file or directory found at <i>path<\/i> and return its contents. For a text file the text is returned and for a directory a collection of directory items is returned.<\/p><\/dd>\n<dt><code><small>void<\/small> remove(<i>path<\/i>)<\/code><\/dt>\n<dd><p>Delete the file or directory found at <i>path<\/i>.<\/p><\/dd>\n<dt><code><small>void<\/small> write(<i>path<\/i>, <i>text<\/i>)<\/code><\/dt>\n<dd><p>Write text to the file found at <i>path<\/i>.<\/p><\/dd>\n<\/dl>\n<h2>Notes<\/h2>\n<p><em>I need to write more stuff here.<\/em><\/p>\n","Templating":"<h2>Command Objects<\/h2>\n<p>First of all read Erik Arvidsson's blog post about his templating engine:<\/p>\n<p><a href='http://erik.eae.net/archives/2005/05/27/01.03.26/'>http://erik.eae.net/archives/2005/05/27/01.03.26/<\/a><\/p>\n<p>MiniWeb's system extends Erik's original. In Miniweb's system all code is evaluated in the scope of a special object called the command object. The command object provides access to functions that facilitate templating (e.g. the <code>include<\/code> function). The MiniWeb command object inherits from the <a href='#File_System'>FileSystem<\/a> object. That means that when templating you have access to functions like <code>read<\/code>, <code>write<\/code>, <code>move<\/code> etc. The Command object extends the FileSystem object by adding methods like <code>include<\/code> and <code>echo<\/code>.<\/p>\n<p>There are two Command objects in use by MiniWeb:<\/p>\n<ol>\n<li>The server's <a href='#JST_Interpreter'>Interpreter<\/a> extends the Command object by providing access to the client's <a href='#Request'>Request<\/a> object<\/li>\n<li>The <a href='#/system/Terminal'>Terminal<\/a> object extends the Command object by providing a mechanism for searching the <code>/bin/<\/code> directory and executing code there<\/li>\n<\/ol>\n<p>So, the class hierarchy for MiniWeb Command objects looks like this:<\/p>\n<pre style='color:#000'>\nBase\n.FileSystem\n..Command\n...Interpreter\n...Terminal\n<\/pre>\n\n<h2>The <code>exec()<\/code> Method<\/h2>\n<p>All Command objects have an <code>exec()<\/code> method. When you call <code>exec(path)<\/code> the file identified by <code>path<\/code> is read and interpreted by the <abbr title='JavaScript Templates'>JST<\/abbr> interpreter. This is what happens when the server returns a page to the client. The page is read and evaluated using <code>exec()<\/code> and the result is returned.<\/p>\n<p>When using the terminal you can issue commands like <code>ls<\/code> (which provides a directory listing). The Terminal is a Command object so it will evaluate the contents of <code>/bin/ls<\/code> and return the result. The <code>ls<\/code> command echoes the result to the terminal window.<\/p>\n<p>You can call <code>exec()<\/code> on <em>any<\/em> file. If the file contains no <abbr>JST<\/abbr> code then <code>exec()<\/code> will simply return the contents of the file. This is <strong>important<\/strong>! Remember: <em>you can execute any file<\/em>. This can be demonstrated clearly in the terminal. Type the name of any file and it will be executed. Most files do not contain any <abbr>JST<\/abbr> code, so <code>exec()<\/code> will simply dump the contents to screen.<\/p>\n<p>When templating you can pass data around using a property of the Command object: <code>target<\/code>.<\/p>\n<p>The <code>target<\/code> property is the most important property of any Command object. <code>target<\/code> is always a string. It often contains the path of another template.<\/p>\n<p>You change the current target by calling <code>exec()<\/code> with a second parameter:<\/p>\n<pre>exec(template, target);<\/pre>\n<p>For example:<\/p>\n<p>The file <code>add-one<\/code> contains the following code:<\/p>\n<pre>\n&lt;%= parseInt(target) + 1 %&gt;\n<\/pre>\n<p>The file <code>test<\/code> contains this code:<\/p>\n<pre>&lt;% echo(exec('add-one', 55)) %&gt;<\/pre>\n<p>If you enter <code>test<\/code> in the terminal window it will return <code>56<\/code>.<\/p>\n<p>You can think of <code>exec()<\/code> as equivalent to calling a function. <code>exec(template, target)<\/code> is equivalent to calling a function called <code>template<\/code> with arguments <code>target<\/code>. Sort of. :-)<\/p>","Request":"<p>The Request object is based on the standard <a href='http://www.w3.org/TR/XMLHttpRequest/'>XMLHttpRequest<\/a> object.<\/p>\n<p>The MiniWeb request object supports the following properties and methods:<\/p>\n<h2>Properties<\/h2>\n<dl>\n<dt><code><small>object<\/small> headers<\/code><\/dt>\n<dd><p>A JavaScript object that contains the request headers (currently both request and response headers).<\/p><\/dd>\n<dt><code><small>string<\/small> method<\/code><\/dt>\n<dd><p>e.g. GET, HEAD, POST.<\/p><\/dd>\n<dt><code><small>number<\/small> readyState<\/code><\/dt>\n<dt><code><small>string<\/small> responseText<\/code><\/dt>\n<dt><code><small>number<\/small> status<\/code><\/dt>\n<dd><p>See the W3C documentation referenced above.<\/p><\/dd>\n<dt><code><small>string<\/small> url<\/code><\/dt>\n<dd><p>The requested url.<\/p><\/dd>\n<\/dl>\n<h2>Methods<\/h2>\n<dl>\n<dt><code><small>string<\/small> getResponseHeader(<i>header<\/i>)<\/code><\/dt>\n<dt><code><small>&nbsp;&nbsp;void<\/small> open(<i>method, url<\/i>)<\/code><\/dt>\n<dt><code><small>&nbsp;&nbsp;void<\/small> send(<i>data<\/i>)<\/code><\/dt>\n<dt><code><small>&nbsp;&nbsp;void<\/small> setRequestHeader(<i>header, value<\/i>)<\/code><\/dt>\n<dd><p>See the W3C documentation referenced above.<\/p><\/dd>\n<\/dl>","MiniWeb_Object":"<h2>Properties<\/h2>\n<dl>\n<dt><code><small>boolean<\/small> dirty<\/code><\/dt>\n<dd><p>A flag indicating that the MiniWeb data has changed since last saved.<\/p><\/dd>\n<dt><code><small>boolean<\/small> readOnly<\/code><\/dt>\n<dd><p>A flag indicating that the MiniWeb server has write access. You will have write access if running from your local hard disk but not if you are viewing the page over <abbr>HTTP<\/abbr>.<\/p><\/dd>\n<dt><code><small>string<\/small> version<\/code><\/dt>\n<dd><p>The version number of MiniWeb.<\/p><\/dd>\n<\/dl>\n<h2>Methods<\/h2>\n<dl>\n<dt><code><small>string<\/small> navigateTo(<i>url<\/i>)<\/code><\/dt>\n<dd><p>Navigate to the page at <i>url<\/i>. Note that <i>url<\/i> is a MiniWeb <abbr>URL<\/abbr> (the hash portion of the full <abbr>URL<\/abbr>).<\/p><\/dd>\n<dt><code><small>string<\/small> refresh()<\/code><\/dt>\n<dd><p>Refresh the page.<\/p><\/dd>\n<dt><code><small>string<\/small> reload()<\/code><\/dt>\n<dd><p>Reload the current page. Similar to <code>refresh<\/code> but data is reloaded from the server.<\/p><\/dd>\n<dt><code><small>string<\/small> resolve(<i>path1<\/i>, <i>path2<\/i>)<\/code><\/dt>\n<dd><p>Build a path from <i>path2<\/i> relative to <i>path1<\/i>.<\/p><\/dd>\n<dt><code><small>void<\/small> save([<i>path<\/i>])<\/code><\/dt>\n<dd><p>Save the current MiniWeb document to disk. If <i>path<\/i> is supplied then it is saved to that location, otherwise it is saved to the current location.<\/p><\/dd>\n<\/dl>\n<h2>Classes<\/h2>\n<dl>\n<dt><code><a href=\"#Request\">Request<\/a><\/code><\/dt>\n<dd><p>The MiniWeb equivalent of an <code>XMLHttpRequest<\/code> object.<\/p><\/dd>\n<\/dl>","default":"<p>Not much help at the moment. Remember that you can edit <a href='javascript:beginEdit()'>anything<\/a>.<p>\n<h2>Client<\/h2>\n<p>Navigate the <a href='#/'>file system<\/a> to examine and edit content.<\/p>\n<h2>Server<\/h2>\n<p>All pages are <em>template driven<\/em>. When constructing templates you may reference commands and properties unique to the <a href='#JST_Interpreter'><abbr title='JavaScript Templates'>JST<\/abbr> interpreter<\/a> which inherits from the <a href=\"#File_System\">FileSystem<\/a> object.<\/p>\n<p>Use the <a href='#/system/Terminal'>Terminal<\/a> to manage files.<\/p>\n<h2>Templating<\/h2>\n<p>Read the <a href='#Templating'>email<\/a> I sent to Brad Neuberg.<\/p>\n<h2>The MiniWeb Object<\/h2>\n<p>The <a href='#MiniWeb_Object'>MiniWeb object<\/a> has a number of public properties and methods to aid scripting.<\/p>"},"edit":"<%\nif (target != self) process('view', query);\n%>","view":"<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01//EN\">\n<html>\n<head>\n<title>MiniWeb: <%= target %><\/title>\n<style class='mw-system' type='text/css'>\n<%\n include('view.css');\n include('edit.css');\n if (isDirectory(target)) include('directory.css');\n%>\n<\/style>\n<script type='text/javascript'>\n<%\n include('view.js');\n include('edit.js');\n%>\n<\/script>\n<\/head>\n<% \n isError = request && request.status > 299;\n level = 0; // heading level\n%>\n<body>\n <div class='mw-header'><% include('header'); %><\/div>\n <div class='mw-content'><% include('content'); %><\/div>\n <div class='mw-footer'><% include('footer'); %><\/div>\n<\/body>\n<\/html>","content":"<% \nlevel++; // heading level\n// sanitise the current target to format a title\nvar title = target.replace(/default$/, '').replace(/\\/(\\w+\\/)*(\\w+)\\/?/, '$2').replace(/_/g, ' ');\nif (title == '/') title = String(MiniWeb);\n%>\n<h<%= level %> class='mw-edit' id='dt-<%= target %>'><%= title %><% if (!isError) include('edit-controls'); %><\/h<%= level %>>\n<div class='mw-data' id='dd-<%= target %>'>\n<%\nif (isDirectory(target)) {\n\tprocess('directory', target);\n} else if (/\\.(css|js)$/.test(target)) {\n%>\n<pre class='mw-plain'><%= escapeHTML(read(target)) %><\/pre>\n<%\n} else {\n\tinclude_once(target);\n}\n%>\n<\/div>\n<%\nlevel--;\n%>\n","header":"<ul class='mw-menu'>\n <li><a href='#/'>Home<\/a><\/li>\n <li><a href='#/blog/'>Blog<\/a><\/li>\n <li><a href='#/system/Administration'>Admin<\/a><\/li>\n <li><a href='#/system/Terminal'>Terminal<\/a><\/li>\n <li><a href='#/system/About'>About<\/a><\/li>\n <li><a href='#/system/Help/'>Help<\/a><\/li>\n <li>--------<\/li>\n <li><a href='#/notes'>notes<\/a><\/li>\n <li class='mw-save'><a id='mw-save'<%= MiniWeb.dirty ? \" class='mw-dirty'\" : '' %> href='javascript:MiniWeb.save()'>Save<\/a><\/li>\n<\/ul>\n","footer":"<p><%= MiniWeb %>, revision <%= read('About/revision') %><\/p>\n","record":"<% \nif (isDirectory(target)) {\n\tforEach (read(target), function(item, name) {\n\t\tif (!item.isDirectory && name != 'default') {\n\t\t\tprocess('content', makepath(target, name));\n\t\t}\n\t});\n}\n%>","directory":"<%\nif (isDirectory(target)) {\n%>\n<table class='mw-directory'>\n<%\n\tvar directory = read(target);\n\tif (target != '/') {\n\t\tdirectory.add('..', null);\n\t}\n\tdirectory.sort();\n\tvar total = 0;\n\tforEach (directory, function(item, name) {\n\t\tvar icon = item.isDirectory ? '[<span>dir<\/span>]' : '';\n\t\tvar href = makepath(target, name);\n\t\tvar type = item.isDirectory ? 'Directory' : 'File';\n\t\tif (item.isDirectory) href += '/';\n\t\ttotal += item.size;\n%>\n<tr class='<%= type.toLowerCase() %><%= name == '..' ? ' parent' : '' %>'>\n<td class='icon'><%= icon %><\/td>\n<td class='size'><% if (type == 'File') echo(item.size + ' bytes'); %><\/td>\n<td><a href='#<%= href %>'><%= name %><\/a><\/td>\n<td style='padding-left:4em'><span class='mw-edit-controls-inactive'><a href='#/system/view!<%= href %>'>view<\/a>\n <a href=\"javascript:delete<%= type %>('<%= href %>')\" class='delete'>delete<\/a>\n <a href='#/system/edit!<%= href %>' class='edit'>edit<\/a><\/span><\/td>\n<\/tr>\n<%\n\t});\n\techo('<tr class=\"total\"><td><\/td><td class=\"size\">' + total + ' bytes<\/td><td>--<\/td><td><\/td><\/tr>');\n%>\n<\/table>\n<%\n}\n%>","Error":{"Moved_Permanently":"<p>The new location of this resource is: <a href=\"<%= request.getResponseHeader(\"Location\") %>\"><%= request.getResponseHeader(\"Location\") %><\/a> or <a href='javascript:history.back()'>go back<\/a>.<\/p>","Not_Found":"<p class='mw-error'>The file <b><%= request.url %><\/b> could not be found.<\/p>\n<% if (isError) { %>\n<p><a href='javascript:createFile(\"<%= request.url %>\")'>Create this entry<\/a> or go <a href='javascript:history.back()'>back<\/a>.<\/p>\n<% } %>","Method_Not_Allowed":"<p class=\"mw-error\">The method <b><%= request.method %><\/b> is not allowed.<\/p>\n<% if (isError) { %>\n<p><a href='mailto:dean@edwards.name'>Report an error<\/a> or <a href='javascript:history.back()'>go back<\/a>.<\/p>\n<% } %>","Internal_Server_Error":"<p>Some kind of error occurred in the fake server that powers MiniWeb:<\/p>\n<% if (isError) { %>\n<blockquote><pre><%= request.error %><\/pre><\/blockquote>\n<p><a href='mailto:dean@edwards.name'>Report this error<\/a> or <a href='javascript:history.back()'>go back<\/a>.<\/p>\n<% } %>","default":"<p><em>Status: <%= request.status %><\/em><\/p>\n<p><%= request.repsonseText %><\/p>"},"About":{"Author":"Dean Edwards","Copyright":"&copy; Dean Edwards 2007","default":"<p>I don't know what this is yet.<\/p>\n<% process('/system/record', path); %>","License":"<a href='http://www.opensource.org/licenses/mit-license'>http://www.opensource.org/licenses/mit-license<\/a>","Version":"<%= MiniWeb.version %>","revision":"1746"},"Terminal":"<style class='mw-system' type='text/css'>\n<% include('terminal.css'); %>\n<\/style>\n\n<div id='form'>\n<%\nvar STATE = '#state';\nvar terminal = MiniWeb.terminal;\nvar state = terminal[STATE];\n%>\n<div id='output'><%= state.output %><\/div>\n<span id='protocol'><%= terminal.protocol %><\/span><span id='path'><%= terminal.path %><\/span>&gt;\n<input id='input' spellcheck='false' autocomplete='off'>\n<\/div>\n\n<script type='text/javascript'>\n<% include('terminal.js'); %>\n<\/script>","edit-controls":"<span class='mw-edit-controls'>\n <span class='mw-edit-controls-inactive'>\n<% if (target != '/') { %>\n  <a href=\"javascript:deleteFile('<%= target %>')\">delete<\/a>\n<% } %>\n<% if (isFile(target)) { %>\n  <a href=\"javascript:beginEdit('<%= target %>')\">edit<\/a>\n<% } %>\n <\/span>\n <span class='mw-edit-controls-active'>\n  <a href=\"javascript:applyEdit('<%= target %>')\">apply<\/a>\n  <a href='javascript:cancelEdit()'>cancel<\/a>\n <\/span>\n<\/span>\n","edit.css":"/* Edit Controls */\n\n.mw-edit, .mw-data {\n\tposition: relative;\n\twidth: 100%;\n}\n\n.mw-edit-controls {\n\tposition: absolute;\n\tdisplay: block;\n\tright: 0;\n\tbottom: 2px;\n\tfont-weight: normal;\n\tcolor: GrayText;\n\ttext-align: right;\n}\n\nh1 .mw-edit-controls {\n\tfont-size: medium;\n}\n\nh2 .mw-edit-controls {\n\tfont-size: small;\n}\n\nh3 .mw-edit-controls {\n\tfont-size: x-small;\n}\n\n.mw-edit-controls a {\n\ttext-decoration: underline;\n\tpadding: 0 3px 0 2px;\n\tcursor: pointer;\n}\n\n.mw-edit-controls-inactive a {\n\tcolor: #408040;\n}\n\n.mw-edit-controls-active a {\n\tcolor: #EE0000;\n}\n\n.mw-active {\n\tcolor: #800000;\n\tborder-color: #800000 !important;\n}\n\n.mw-edit-controls-active,\n.mw-active .mw-edit-controls-inactive {\n\tdisplay: none;\n}\n\n.mw-edit-controls-inactive,\n.mw-active .mw-edit-controls-active {\n\tdisplay: block;\n}\n\n.mw-editor {\n\twidth: 100%;\n\tmargin: 0;\n\tborder: 1px solid #EFE7E7;\n}\n","edit.js":"var Request = MiniWeb.Request;\nvar title, content, editor;\nvar editing = false;\n\n<% if (top == '/system/edit') { %>\nextend(window, 'onload', function() {\n\tthis.base();\n\tbeginEdit();\n});\n<% } %>\n\nwindow.onunload = function() {\n\tRequest = null;\n};\n\nfunction applyEdit(target) {\n\tPUT(target, editor.value);\n<% if (top == '/system/edit') { %>\n\tMiniWeb.navigateTo(target);\n<% } else { %>\n\tMiniWeb.reload();\n<% } %>\n};\n\nfunction beginEdit(target, maximise) {\n\tif (editing) cancelEdit();\n\tediting = true;\n\tif (!target) target = '<%= target %>';\n\ttarget = target.replace(/^.*!/, \"\");\n\ttitle = $('dt-' + target);\n\ttitle.className = 'mw-edit mw-active';\n\tvar level = parseInt(title.tagName.slice(1));\n\tcontent = $('dd-' + target);\n\tif (maximise || level == 1) {\n\t\tvar height = parent.document.body.clientHeight - content.offsetTop - 64;\n\t} else {\n\t\theight = 48;\n\t}\n\teditor = document.createElement('textarea');\n\teditor.className = 'mw-editor';\n\teditor.spellcheck = false;\n\teditor.style.height = height + 'px';\n\teditor.value = GET(target, {'Content-Type': 'text/plain'});\n\tcontent.parentNode.insertBefore(editor, content);\n\tcontent.style.display = 'none';\n\teditor.focus();\n};\n\nfunction cancelEdit() {\n\tediting = false;\n<% if (query && top == '/system/edit') { %>\n\thistory.back();\n<% } else { %>\n\ttitle.className = 'mw-edit';\n\tcontent.parentNode.removeChild(editor);\n\tcontent.style.display = 'block';\n<% } %>\n};\n\nfunction deleteFile(target) {\n\tif (confirm('Delete ' + target + '?')) {\n\t\tDELETE(target);\n\t\tif (MiniWeb.client.address == target) {\n\t\t\thistory.back();\n\t\t} else {\n\t\t\tMiniWeb.reload();\n\t\t}\n\t}\n};\n\nfunction deleteDirectory(name) {\n\tdeleteFile(name);\n};\n\nfunction GET(url, header) {\n\treturn new Request('GET', url, null, header).responseText;\n};\n\nfunction PUT(url, data) {\n\tnew Request('PUT', url, data);\n};\n\nfunction DELETE(url) {\n\tnew Request('DELETE', url);\n};\n","directory.css":"/* Directory View */\n\n.mw-directory {\n\tfont-family: \"Lucida Console\", monspoace; font-size: small;\n}\n\n.mw-directory .directory a.edit,\n.mw-directory .parent a.delete {\n\tvisibility: hidden;\n}\n\n.mw-directory .total td {\n\tpadding-top: 1em;\n}\n\n.mw-directory .mw-edit-controls-inactive {\n\tposition: static;\n\ttext-align: right;\n}\n\n.mw-directory .mw-edit-controls-inactive a {\n\tmargin-right: 1ex;\n}\n\n.mw-directory td {\n\tpadding-right: 1em;\n\tvertical-align: baseline;\n}\n\n.mw-directory .icon span {\n\tbackground-color: #FFFFCC;\n}\n\n.mw-directory .size {\n\tpadding-right: 2em;\n\ttext-align: right;\n}","view.js":"var base = new Function;\n\nvar $ = function(id) {\n\treturn document.getElementById(id);\n};\n\nwindow.onload = function() {\n\tvar styles = document.getElementsByTagName('style');\n\tforEach (styles, function(style) {\n\t\tif (style.className != 'mw-system') {\n\t\t\tstyle.parentNode.removeChild(style);\n\t\t}\n\t});\n};\n","view.css":"/* Structure */\n\nhtml {\n\tmargin: 0;\n\tpadding: 0;\n}\n\nbody {\n\tmargin: 0;\n\tpadding: 1.33em 0;\n}\n\ntd {\n\tfont-size: 1em;\n}\n\n.mw-header, .mw-footer {\n\tposition: absolute;\n\tleft: 0;\n\twidth: 100%;\n\theight: 1.33em;\n\tz-index: 999;\n}\n\n.mw-header {\n\ttop: 0;\n}\n\n.mw-footer {\n\tbottom: 0;\n}\n\n@media screen {\n\tbody > .mw-header,\n\tbody > .mw-footer {\n\t\tposition: fixed;\n\t}\n}\n\n* html body {\n\toverflow: hidden;\n} \n\n* html .mw-content {\n\theight: 100%;\n\toverflow: auto;\n}\n\n.mw-content {\n\tpadding: 0 4em 0 2em;\n\tmargin: 2em 0;\n}\n\n* html .mw-content {\n\tpadding-top: 2em;\n}\n\n/* Style */\n\nbody {\n\tfont-family: Verdana, Arial, sans-serif;\n}\n\np {\n\tline-height: 1.33em;\n\ttext-align: justify;\n}\n\ncode, pre {\n\tcolor: darkred;\n}\n\npre {\n\tbackground-color: #FCFCFC;\n\tborder: 1px solid #CCC;\n\tpadding: 1ex;\n\tmargin: 1em 2em 1em 1em;\n}\n\npre, textarea {\n\tfont-family: \"Lucida Console\", monospace;\n\tfont-size: small;\n\t_font-size: x-small;\n}\n\npre.mw-plain {\n\tcolor: black;\n\tmargin: 0;\n\tpadding: 1px;\n\tborder: none;\n\tbackground-color: transparent;\n}\n\ndt code {\n\tfont-weight: bold;\n\tcolor: #000;\n}\n\ndt small, dt i {\n\tfont-weight: normal;\n\tcolor: darkred;\n}\n\n.mw-header, .mw-footer {\n\tbackground-color: #222;\n\tcolor: #FFF;\n\tfont-size: smaller;\n}\n\n.mw-header {\n\tfont-weight: bold;\n}\n\n.mw-footer p {\n\tmargin: 0;\n\tpadding-right: 1ex;\n\ttext-align: right;\n}\n\n/* Links */\n\na {\n\tcolor: #00E;\n\tcursor: pointer;\n\ttext-decoration: underline;\n}\n\na.mw-visited,\na[href^=\"http\"]:visited,\na[href^=\"javascript\"]:visited,\na[href^=\"mailto\"]:visited {\n\tcolor: #551A8B;\n}\n\na.mw-new {\n\tcolor: #E00;\n\ttext-decoration: none;\n}\n\na.mw-new:hover {\n\ttext-decoration: underline;\n}\n\n/* Menu */\n\n.mw-menu {\n\tmargin: 0;\n\tpadding: 0;\n}\n\n.mw-menu li {\n\tdisplay: inline;\n}\n\n.mw-menu a {\n\tcolor: #FFF !important;\n\ttext-decoration: none !important;\n\tpadding: 0 1ex;\n}\n\n.mw-menu a:hover {\n\tbackground-color: #FFFFFF !important;\n\tcolor: #222 !important;\n}\n\n.mw-save {\n\tposition: absolute;\n\ttop: 0;\n\tright: 1ex;\n}\n\n#mw-save.mw-dirty {\n\tcolor: #F00 !important;\n}\n\n/* Headings */\n\n* + html h1 {\n\tmargin: 1.67em 0 0.67em 0;\n}\n\n* html h1 {\n\tmargin: 1.67em 0 0.67em 0;\n}\n\nh1 {\n\tborder-bottom: 2px solid;\n}\n\nh2 {\n\tborder-bottom: 1px solid #808080;\n}\n\n/* Other */\n\np.mw-error b {\n\tcolor: #E00;\n}\n","terminal.js":"var ABS    = /^\\//;\nvar BIN    = '/bin/';\nvar STATE  = '#state';\nvar HIDDEN = 'valueOf';\nvar TMP    = HIDDEN;\nvar STDIN  = 0;\nvar STDOUT = 1;\n\nextend(window, \"onload\", function() {\n\tthis.base();\n\tsetFocus();\n});\n\nvar terminal = MiniWeb.terminal;\nvar state = terminal[STATE];\nvar form = $('form');\nvar input = $('input');\nvar output = $('output');\nvar path = $('path');\nvar protocol = $('protocol');\nvar saveButton = $('mw-save');\nvar textContent = output.textContent ? 'textContent' : 'innerText';\n\nfunction setFocus() {\n\tvar client = input.scrollParent || document.documentElement;\n\tif (!base2.detect('MSIE')) client.scrollTop = client.scrollHeight;\n\tinput.focus();\n};\n\nfunction clean(method) {\n\tvar dirty = MiniWeb.dirty\n\tmethod.apply(terminal, slice(arguments, 1));\n\tMiniWeb.dirty = dirty;\n};\n\nfunction lookup(command) {\n\tvar path = terminal.path.split('/');\n\tdo {\n\t\tpath.pop();\n\t\tvar lookup = path.join('/') + '/bin/' + command;\n\t} while (path.length && !terminal.exists(lookup));\n\treturn lookup;\n};\n\ninput.style.width = (form.offsetWidth - input.offsetLeft) + 'px';\n\ninput.onkeydown = function(event) {\n\tevent = event || window.event;\n\tswitch (event.keyCode) {\n\t\tcase 13: // return\n\t\t\tvar $output = [];\n\t\t\tstate.commands[state.position++] = input.value;\n\t\t\tstate.commands.length = state.position;\n\t\t\tvar prompt = state.protocol + terminal.path + '> ';\n\t\t\t$output.push(prompt + input.value);\n\t\t\tvar streams = trim(input.value).split(/\\s*>\\s*/);\n\t\t\tvar $input = streams[STDIN].split(/\\s+/);\n\t\t\tvar command = $input[0];\n\t\t\tif (command) {\n\t\t\t\tvar template = command;\n\t\t\t\tvar target = $input.slice(1).join(' ');\n\t\t\t\tif (!terminal.isFile(template) && !ABS.test(template) && terminal.isFile(lookup(template))) {\n\t\t\t\t\tclean(terminal.copy, lookup(template), TMP);\n\t\t\t\t\ttemplate = TMP;\n\t\t\t\t}\n\t\t\t\tif (terminal.isFile(template)) {\n\t\t\t\t\tvar result = terminal.exec(template, target);\n\t\t\t\t\tclean(terminal.remove, TMP);\n\t\t\t\t\tif (streams[STDOUT]) {\n\t\t\t\t\t\tterminal.write(streams[STDOUT], result);\n\t\t\t\t\t} else if (trim(result)) {\n\t\t\t\t\t\t$output.push(result);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (command == 'clear') {\n\t\t\t\t\t\toutput.innerHTML = '<pre>' + MiniWeb + '<\/pre><br>';\n\t\t\t\t\t\t$output = [];\n\t\t\t\t\t} else if (command == 'cd') {\n\t\t\t\t\t\tif (terminal.isDirectory(target)) {\n\t\t\t\t\t\t\tterminal.chdir(target);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$output.push('No such directory.');\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$output.push('File not found: ' + command);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tsaveButton.className = MiniWeb.dirty ? 'mw-dirty' : '';\n\t\t\t}\n\t\t\tfor (var i = 0; i < $output.length; i++) {\n\t\t\t\tvar node = document.createElement('pre');\n\t\t\t\tnode[textContent] = $output[i];\n\t\t\t\toutput.appendChild(node);\n\t\t\t}\n\t\t\tif (i) {\n\t\t\t\toutput.appendChild(document.createElement('br'));\n\t\t\t}\n\t\t\tstate.output = output.innerHTML;\n\t\t\tpath[textContent] = terminal.path;\n\t\t\tprotocol[textContent] = terminal.protocol;\n\t\t\tinput.style.width = '0px'; // force recalc\n\t\t\tinput.style.width = (form.offsetWidth - input.offsetLeft) + 'px';\n\t\t\tinput.value = '';\n\t\t\tsetFocus();\n\t\t\treturn false;\n\t\tcase 38: // up-arrow\n\t\t\tif (state.position > 0) {\n\t\t\t\tinput.value = state.commands[--state.position];\n\t\t\t}\n\t\t\treturn false;\n\t\tcase 40: // down-arrow\n\t\t\tif (state.position < state.commands.length - 1) {\n\t\t\t\tinput.value = state.commands[++state.position];\n\t\t\t}\n\t\t\treturn false;\n\t}\n};\n","terminal.css":"#form, #input, #output, pre {\n\tfont-family: \"Lucida Console\", monospace;\n\tfont-size: small;\n\t_font-size: x-small;\n\tborder-width: 0;\n\tmargin: 0;\n\tpadding: 0;\n\tbackground-color: transparent;\n\tcolor: black;\n}\n\n#input {\n\tdisplay: inline;\n\tvertical-align: bottom;\n}\n\n#output pre {\n\tmax-width: 60em;\n\t_width: 60em;\n\twhite-space: pre-wrap;\n\twhite-space: -moz-pre-wrap;\n\twhite-space: -pre-wrap;\n\twhite-space: -o-pre-wrap;\n\tword-wrap: break-word;\n\t_padding-top: 1px;\n}\n"},"notes":"<p>Stuff I gotta do:<\/p>\n<ul>\n <li><code>cd<\/code> is currently hard coded in <a href='#/system/terminal.js'><code>terminal.js<\/code><\/a><\/li>\n <li><del>client scripts don't need to maintain dirty state of MiniWeb<\/del><\/li>\n <li><del>simpler JST parser<\/del> simplify it further<\/li>\n <li><del>get templating working<\/del> <del>now get system inheritance working<\/del><\/li>\n <li><del>use echo() properly in Terminal<\/del><\/li>\n <li><del>../relative urls and<\/del> wild cards (*)<\/li>\n <li>Support more file systems: <ul>\n  <li><del>JSON<\/del><\/li>\n  <li>HTML<\/li>\n  <li>file://<\/li>\n  <li>Ajax<\/li>\n <\/ul><\/li>\n <li>ISO date parsing<\/li>\n <li>import/export<\/li>\n <li>Preferences: <ul>\n  <li>Markdown/HTML/Plain text<\/li>\n <\/ul><\/li>\n<\/ul>","blog":{"categories":{"General":"","JavaScript":"","Base":""},"Properties":{"Author":"Dean Edwards","Copyright":"&copy; Dean Edwards 2006","title":"A Sample MiniBlog","default":"<% process(\"/system/Content\", \"*\"); %>"},"About":"<p>Write about yourself.<\/p>","Manage":"<p>You are invited to customise your blog:<\/p>\n<ul>\n <li>Edit blog <a href='#/blog/Properties/'>properties<\/a><\/li>\n <li>Edit blog <a href='#/blog/Preferences'>preferences<\/a><\/li>\n <li>Edit the default <a href='#/system/edit!/blog/system/view'>view<\/a> (page structure)<\/li>\n <ul>\n  <li>Edit the <a href='#/system/edit!/blog/system/menu'>menu<\/a> template<\/li>\n  <li>Edit the <a href='#/system/edit!/blog/system/content'>content<\/a> template<\/li>\n  <li>Edit the <a href='#/system/edit!/blog/system/footer'>footer<\/a> template<\/li>\n  <li>Edit the <a href='#/system/edit!/blog/system/view.css'>style<\/a><\/li>\n <\/ul><\/li>\n <li>Edit <a href='#/system/edit!/blog/Manage'>this<\/a> page<\/li>\n<\/ul>\n<p>If you are feeling adventurous you can use the <a href='#/system/Terminal'>terminal<\/a> to modify the file system.<\/p>","Help":"<h2>How to use your blog<\/h2>\n<p>I need to write something here.<\/p>","Edit":"<% process('Write', target); %>","system":{"menu":"<ul class='menu'>\n <li class='mw-save'><a id='mw-save'<%= MiniWeb.dirty ? \" class='mw-dirty'\" : '' %> href='javascript:MiniWeb.save()'>Save<\/a><\/li>\n <li><a href='#/' title='Go to the MiniWeb start page'>/<\/a><\/li>\n <li><a href='#/blog/' title='Go to the start page of your blog'>Home<\/a><\/li>\n <li><a href='#/blog/Manage' title='Mange your blog'>Manage<\/a><\/li>\n <li><a href='#/blog/Write' title='Write a new post'>Write<\/a><\/li>\n <li><a href='#/blog/About/' title='About this blog'>About<\/a><\/li>\n<\/ul>\n","title":"<h1><%= read('/blog/Properties/title') %><\/h1>\n","footer":"<h3>Search<\/h3>\n<h3>Categories<\/h3>\n<h3>Archives<\/h3>","meta":"<p><%= MiniWeb %> | Revision <%= read('/system/Document/revision') %><\/p>\n","content":"<% if (target != '/blog/default') { %>\n<h2><%= target.replace(/\\/(\\w+\\/)*(\\w+)\\/?/, '$2').replace(/_/g, ' ') %><\/h2>\n<% } %>\n<div>\n<% include_once(target); %>\n<\/div>","view":"<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01//EN\">\n<html>\n<head>\n<title>MiniBlog: <%= target %><\/title>\n<style type='text/css'>\n<% include('view.css'); %>\n<\/style>\n<\/head>\n<% \n isError = request && request.status > 299;\n%>\n<body>\n <div class='title'><% include('title'); %><\/div>\n <div class='menu'><% include('menu'); %><\/div>\n <div class='content'><% include('content'); %><\/div>\n <div class='footer'><% include('footer'); %><\/div>\n <div class='meta'><% include('meta'); %><\/div>\n<\/body>\n<\/html>","view.css":"/* Structure */\n\nhtml {\n\tmargin: 0;\n\tpadding: 0;\n}\n\nbody {\n\tfont-family:\"Lucida Grande\", Verdana, Arial, Sans-Serif;\n\tmargin: 0;\n\tpadding: 2em 8em;\n\tbackground-color: #222222;\n}\n\n/* Colour */\n\ndiv.title , div.menu, div.content, div.footer, div.meta {\n\tcolor: #FFFFFF;\n\tmargin-top: 8px;\n\tpadding: 1ex 2em;\n\t-moz-border-radius: 5px;\n\tborder-radius: 5px;\n}\n\ndiv.title {\n\tbackground-color: #DD8822;\n}\n\ndiv.menu, div.meta {\n\tbackground-color: #88CC22;\n\tpadding: 2px 2em;\n\tfont-size: smaller;\n}\n\ndiv.content {\n\tbackground-color: #EEEEEE;\n\tcolor: #000000;\n}\n\ndiv.footer {\n\tbackground-color: #2288CC;\n\tfont-size: smaller;\n}\n\ndiv.footer, div.meta {\n\ttext-align: center;\n}\n\ndiv.meta p {\n\tmargin: 0;\n}\n\nh2 {\n\tborder-bottom: 2px solid;\n}\n\n/* Links */\n\na {\n\tcolor: #FFFFFF;\n\tcursor: pointer;\n\ttext-decoration: none;\n}\n\ndiv.content a {\n\tcolor: #0000EE;\n\ttext-decoration: underline;\n}\n\ndiv.content a:visited,\ndiv.content a[href^=\"http\"]:visited,\ndiv.content a[href^=\"javascript\"]:visited,\ndiv.content a[href^=\"mailto\"]:visited {\n\tcolor: #551A8B;\n}\n\na.mw-new {\n\tcolor: #EE0000;\n\ttext-decoration: none;\n}\n\na.mw-new:hover {\n\ttext-decoration: underline;\n}\n\n/* Menu */\n\nul.menu {\n\tmargin: 0;\n\tpadding: 0;\n\tfont-weight: bold;\n\ttext-transform: uppercase;\n}\n\nul.menu li {\n\tdisplay: inline;\n\tmargin-right: 1em;\n}\n\nul.menu a {\n\ttext-decoration: none;\n\tcolor: #FFFFFF;\n}\n\nul.menu a:hover {\n\ttext-decoration: underline;\n}\n\nul.meta {\n\tfont-size: smaller;\n}\n\n.mw-save {\n\tfloat: right;\n}\n\n#mw-save.mw-dirty {\n\tcolor: #F00 !important;\n}\n"},"posts":{"Welcome":{"Title":"Welcome!","Content":"<p>Welcome to MiniBlog!<\/p>\n<p>This blog is a sample MiniWeb application. It has its own look and feel separate from the MiniWeb core. The posting mechanism is a simple <abbr>HTML<\/abbr> form.<\/p>","Categories":"","Timestamp":"2006-12-03T04:18:32","Format":"HTML"},"Expand_This_Blog":{"Title":"Expand This Blog!","Content":"<p>The MiniWeb blog application is only partially complete. Do you want to finish it? The following features are incomplete:<\/p>\n<ul>\n<li>blog categories<\/li>\n<li>search<\/li>\n<li>better navigation (archives)<\/li>\n<li>a better theme!<\/li>\n<\/ul>\n<p>Send your improved MiniBlog to <a href='mailto:dean@edwards.name'>dean@edwards.name<\/a>.<\/p>","Categories":"","Timestamp":"2007-04-26T20:35:41","Format":"HTML"}},"Post":"<%\nif (isDirectory(target)) {\n chdir(target);\n%>\n<div class='post'>\n <h2><%= read('Title') %><\/h2>\n <%= read('Content') %>\n <ul class='meta'>\n  <li>Posted on: <%= read('Timestamp') %><\/li>\n  <li>Categories: <%= read('Categories') %><\/li>\n  <li><a href='#Edit!<%= target.replace(/^.*\\//, '') %>'>Edit this post<\/a><\/li>\n <\/ul>\n<\/div>\n<% } %>","Preferences":{},"Write":"<style type='text/css'>\ntextarea.editor, input {border: 1px solid silver;}\ntextarea.editor {width: 100%; margin-top: 0; clear: both;}\n#title, ul.meta h3 {border-bottom: none; margin-bottom: 0;}\nul.meta h3 {font-size: 1em;}\n#title input {font: inherit; float: left; border-bottom-width: 0;}\n#title button {float: left; margin-left: 8px;}\nul.meta {list-style: none; margin: 1em 0; padding: 0;}\nul.meta li {float: left; margin-right: 2em;}\n#title {zoom: 1; font-family: \"Lucida Grande\", Verdana, Arial, Sans-Serif;}\nh2 input {font-size: 1em; font-weight: bold;}\n<\/style>\n<% if (request.post && request.post.Title) {\n\tvar slug = request.post.Title.replace(/\\s+/g, '_');\n\twrite('/blog/posts/' + slug, JSON.copy(request.post));\n%>\n<p class='message'>Post saved. <a href='#/blog/'>View blog posts<\/a>.<\/p>\n<% } %>\n<form>\n<%\nvar post = {\n\tTitle: '',\n\tContent: '',\n\tTimestamp: JSON.parse(JSON.toString(new Date)),\n\tFormat: '',\n\tCategories: ''\n};\nif (query) {\n\tvar postDir = 'posts/' + query + '/';\n\tforEach (read(postDir), function(item, name) {\n\t\tpost[name] = read(postDir + name);\n\t});\n}\n%>\n<h2 id='title'><input name='Title' value='<%= escapeHTML(post.Title) %>'><button type='submit' value='post'>Post<\/button><\/h2>\n<script type='text/javascript'>\nvar title = document.getElementById('title');\ntitle.firstChild.style.width = (title.offsetWidth - title.lastChild.offsetWidth - 32) + 'px';\n<\/script>\n<textarea name='Content' class='editor' rows='16'><%= escapeHTML(post.Content) %><\/textarea>\n<br style='clear:both'>\n<ul class='meta'>\n <li><h3>Categories<\/h3>\n<%\n var categories = read('categories');\n%>\n  <select name='Categories' size='<%= Math.min(categories.count(), 8) %>' multiple>\n<%\n forEach (categories, function(item, category) {\n%>\n   <option><%= category %><\/option>\n<%\n });\n%>\n  <\/select><\/li>\n <li><h3>Timestamp<\/h3><input name='Timestamp' value='<%= post.Timestamp %>'><\/li>\n <li><h3>Format<\/h3>\n  <select name='Format'>\n   <option>HTML<\/option>\n   <option disabled>Markdown<\/option>\n  <\/select><\/li>\n<\/ul>\n<\/form>\n<br style='clear:both'>\n<hr>\n<br style='clear:both'>","default":"<%\nvar posts = read('posts');\nvar max = Math.max(posts.count(), 8);\nposts.reverse();\nfor (var i = 0; i < max; i++) {\n\tprocess(\"Post\", 'posts/' + posts.keys(i));\n}\n%>"},"examples":{"Simple_Form":"<form>\n <input type='text' name='text'>\n <button type='submit'>echo<\/button>\n<\/form>\n<hr>\n<p><%= request.post.text %><\/p>\n","Calculator":"<form>\n <input type='text' name='expression'>\n <button type='submit'>evaluate<\/button>\n<\/form>\n<hr>\n<% if (request.post) { %>\n<p><%= exec('bin/calc', request.post.expression) %><\/p>\n<% } %>\n","bin":{"hello-world":"<%='Hello World!'%>","multiply":"<%\nfunction multiply(first, second) {\n  return first * second;\n};\nvar factors = args();\nvar product = reduce(factors, multiply, 1);\necho(product);\n%>","calc":"<%\nvar result = NaN;\nvar INVALID = /[^\\s\\d\\/%*.+-]/;\ntry {\n\tif (!INVALID.test(target)) {\n\t\tresult = Number(eval(target));\n\t}\n} catch (e) {\n\t// ignore\n} finally {\n\tif (isNaN(result)) {\n\t\tresult = 'invalid expression';\n\t}\n\techo(result);\n}\n%>"}},"bin":{"echo":"<%= target %>","cat":"<%\nforEach (args(), function(path, index) {\n\tif (index) echo('\\n');\n\tif (path) echo(read(path));\n});\n%>","cp":"<%\nargs('path1,path2');\nif (path1 && path2) {\n\tif (exists(path1)) {\n\t\tcopy(path1, path2);\n\t} else {\n\t\techo(path1 + ': file not found.');\n\t}\n}\n%>","mv":"<%\nargs('path1,path2');\nif (path1 && path2) {\n\tif (exists(path1)) {\n\t\tmove(path1, path2);\n\t} else {\n\t\techo(path1 + ': file not found.');\n\t}\n}\n%>","rmdir":"<%\nif (isDirectory(target)) {\n\tremove(target);\n} else if (isFile(target)) {\n\techo(target + ': is not a directory.');\n} else {\n\techo(target + ': file not found.');\n}\n%>","rm":"<%\nif (target != self) {\n\tif (isFile(target)) {\n\t\tremove(target);\n\t} else if (isDirectory(target)) {\n\t\techo(target + ': can\\'t delete a directory. use \"rmdir\" or \"rm -r\" instead.');\n\t} else {\n\t\techo(target + ': file not found.');\n\t}\n}\n%>","ed":"<%\n// open the file in the system editor\nif (target != self) {\n\tif (isDirectory(target)) {\n\t\techo('Cannot edit a directory.');\n\t} else {\n\t\tMiniWeb.navigateTo('/system/edit!' + makepath(target));\n\t}\n}\n%>","date":"<%= new Date().toLocaleString() %>","help":"Sorry. There is not much help yet. Try using UNIX commands (mostly). Here is a quick dump of available commands. You will have to work out what they do yourself:\n\n<%= read('/bin').filter(function(item) {\n  return !item.isDirectory;\n}).join('  ') %>\n\nYou can also call 'clear' to clear the terminal and 'cd' to change directory.","mkdir":"<%\nif (isDirectory(target)) {\n\techo(target + ': is already a directory.');\n} else if (isFile(target)) {\n\techo(target + ': is already a file.');\n} else {\n\tmkdir(target);\n}\n%>","save":"<%\nif (self != target) {\n\techo(target ? 'saved as ' + target : 'saved.');\n\tMiniWeb.save(target);\n}\n%>","time":"<%= new Date().toLocaleTimeString() %>","grep":"<%\nif (target != self) {\n\targs('pattern,path');\n\tif (isDirectory(path)) {\n\t\tif (!/\\/$/.test(path)) {\n\t\t\tpath += \"/\";\n\t\t}\n\t\tforEach (read(path), function(data, name) {\n\t\t\techo(exec(self, pattern + ' ' + path + name));\n\t\t});\n\t} else if (isFile(path)) {\n\t\tpattern = new RegExp(pattern);\n\t\tif (pattern.test(read(path))) {\n\t\t\techo(path + ' matches.\\n');\n\t\t}\n\t} else {\n\t\techo(path + ': no such file or directory.\\n');\n\t}\n}\n%>","ls":"<%\n// display the contents of a directory\nif (isDirectory(target)) {\n\tvar PADDING = '           ';\n\tvar files = read(target).map(function(item, name) {\n\t\tname += item.isDirectory ? '/' : '';\n\t\treturn name + PADDING.slice(name.length % PADDING.length);\n\t});\n\techo(files.sort().join(''));\n} else {\n\techo('no such directory.');\n}\n%>","manual":{"ed":"usage: ed <path>\n\nEdit the file identified by path.","echo":"usage: echo <text>\n\nWrite text to the output buffer.","date":"usage: date\n\nReturns the current date.","time":"usage: time\n\nReturns the current time."},"man":"<%\nif (isFile('/bin/manual/' + target)) {\n\techo('help for command: ' + target + '\\n\\n' + exec('/bin/manual/' + target));\n} else if (!isFile('/bin/' + target)) {\n\techo('command not found: ' + target);\n} else {\n\techo('help not found for command: ' + target);\n}\n%>"}}</script>
<body>