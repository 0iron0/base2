<html>
<head>
	<title> Uri RegExp demo v0.3</title>
	<link href="Uri.css" rel="stylesheet" type="text/css">
	<script src="../uri.js" type="text/javascript" charset="utf-8"></script>
	<script src="../../langcontrib.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript" charset="utf-8">
function setId(id,value) { $(id).innerHTML=typeof value=='string'?value:"<em>"+value+"</em>"; }
function CreateTable(container) {
	var res=$(container);
	if(res.firstChild==null) {
		var a='<table>,<col style="width:75px">,<col style="width:100%">'.split(",");
		for(var i=0; i<URIMATCH_NAMES.length; i++) {
			var name=URIMATCH_NAMES[i];
			a.push('<tr><th>'+name+'</th><td id="container_'+(i+1)+'">-</td></tr>');
		}
		a.push("</table>");
		res.innerHTML=a.join("\n");
	}
	return res;
}
function setTbl(a) {
	var container=$(container);
	for(var i=1; i<a.length; i++) {
		setId("container_"+i, a[i]);
	}
}
function setErr(s) { $("error").innerHTML=s; }
function setMsg(s) { $("msg").innerHTML=s; }
function parse() {
	setTbl("-,-,-,-,-,-,-,-".split(','));
	setErr("");
	setMsg("");
	try {
		var full=$("full").checked;
		var rx=full ? new RegExp("^"+URIRX+"$") : RXURI;
		var uri=getUri();
		var matches=rx.exec(uri);
		if(matches) {
			setTbl(matches);
			if(!full) {
				var match=matches[0], i=matches.index, j=matches.index+match.length;
				var link=uri.slice(i,j);
				setMsg(uri.slice(0,i)+'<a href="'+link+'">'+link+"</a>"+uri.slice(j));
			}
		}
		else setErr("No match");
	}
	catch(ex) {
		setErr(ex.toString());
	}
}
function PreventDefault(e) {
	if(e.preventDefault) e.preventDefault();
	e.returnValue=true;
}
function setUriState() {
  var oneLine=$("full").checked;
  $('uri').style.display=oneLine?"block":"none";
  $('uritext').style.display=oneLine?"none":"block";
}
function swapUriBoxes() {
  setUriState();
  $(getUriId()).value=$(getNoneUriId()).value;
}

function getUriId() {return $("full").checked?"uri":"uritext"; }
function getNoneUriId() {return $("full").checked?"uritext":"uri"; }
function setUri(txt) {
	if(!$("full").checked) txt="The link "+txt+" is recognized.";
	$(getUriId()).value=txt; 
}
function getUri() { return $(getUriId()).value; }
window.onload=function() {
	CreateTable('tbl');
	setUriState();
	setUri(location.href);
	$('full').onclick=swapUriBoxes;
	$('uris').onchange=function(e) {
		var o=this.options[this.selectedIndex];
		if(o.disabled) this.selectedIndex=this.lastSelectedIndex||-1;
		else {
			this.lastSelectedIndex=this.selectedIndex;
			setUri(o.text);	
		}
	}
}
	</script>
</head>
<body>
	<h1>Uri RegExp demo</h1>
	<form class="block" onsubmit="return false;">
		<h2>Input</h2>
		<label for="uri" class="top">Uri</label>
		<input type="text" id="uri">
		<textarea id="uritext" rows="3"></textarea>
		<input type="button" value="Parse" onclick="parse();">
		<input type="checkbox" id="full" checked title="If unchecked, the parser will look for the first link in the text."><label for="full" title="If unchecked, the parser will look for the first link in the text.">Only match complete string</label>

		<label for="uris" class="top">Samples</label>
		<select size="18" id="uris">
			<option>http://mcbak.local/~doekman/b2/uri.html</option>
			<option>https://user%20name@10.10.0.154:443/folder/file.htm?name=Doeke%20Zanstra&amp;dbg=false#Chapter%20four</option>
			<option>http:/~doekman/b2/uri.html?q=Test#Chapter%20</option>
			<option>mailto:d.zanstra@catsdeep.com?subject=Testing</option>
			<option>http://en.wikipedia.org/wiki/URL#URI.2FURL_syntax_in_brief</option>
			<option>http://www.google.com/search?client=safari&amp;rls=en-us&amp;q=base2&amp;ie=UTF-8&amp;oe=UTF-8</option>
			<option>ftp://user@ftp.xs4all.nl/path/to/something</option>
			<optgroup label="rfc3986 examples">
			   	<option>ftp://ftp.is.co.za/rfc/rfc1808.txt</option>
			   	<option>http://www.ietf.org/rfc/rfc2396.txt</option>
			    <option>mailto:John.Doe@example.com</option>
			    <option>news:comp.infosystems.www.servers.unix</option>
			    <option>tel:+1-816-555-1212</option>
			    <option>telnet://192.0.2.16:80/</option>
		    	<option>urn:oasis:names:specification:docbook:dtd:xml:4.1.2</option>
			</optgroup>
			<optgroup label="IPv6 is not yet supported">
		    	<option disabled class="disabled">ldap://[2001:db8::7]/c=GB?objectClass?one</option>
			</optgroup>
		</select>
	</form>
	<div class="block">
		<h2>Result</h2>
		<div id="error"></div>
		<div id="msg"></div>
		<div id="tbl"></div>
		<p>Examine the <a href="../uri.js">javscript regular expression</a>.</p>
	</div>
</body>
</html>
